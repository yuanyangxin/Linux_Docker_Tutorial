

# 安装步骤

## step1 ：装显卡驱动

直接装cuda里面的驱动，nividia官网下的驱动可能会安装失败

官网获取最新版本cuda：https://developer.nvidia.com/cuda-zone

（可以把当前用户加入docker用户组。这样就不用每次都加sudo) 



## step2：安装docker-ce

下最新版本

https://docs.docker.com/engine/install/ubuntu/



## step3：安装nvidia-docker


https://github.com/NVIDIA/nvidia-docker



## step4：新加硬盘时进行以下操作，否则跳过

硬盘空间不够，增加新硬盘后需要挂载硬盘，更改docker路径（安装新硬盘后需要这一步，否则跳过）

挂载硬盘参考：https://blog.51cto.com/12348890/2092339

更改docker路径参考：https://blog.csdn.net/weixin_32820767/article/details/81196250



## step5：固定服务器的IP地址

 sudo vim /etc/netplan/50-cloud-init.yaml

```
network:
    ethernets:
        eno1: --eno1要改为自己的网卡名
            dhcp4: no
            addresses: [10.129.27.14/24] --静态ip
            optional: true
            gateway4: 10.129.27.1 --网关
            nameservers:
                addresses: [114.114.114.114]
    version: 2
```

配置完成后，保存并退出，执行 netplan apply 命令可以让配置直接生效



## step6：容器管理

（1）安装protainer（单机版就行）  https://www.portainer.io/



http://10.129.27.15:9000/

yuanyangxin

Ab123321



（2）安装完成后浏览器打开 固定IP:9000，进入容器管理界面，新建管理员用户，选择docker进入管理界面

![image-20200916160212597](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200916160212597.png)

![image-20200916160222593](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200916160222593.png)



（3）protainer 新建container

image可以直接copy老系统上的配置，或者自己用dockerfile编译

22端口是ssh，8888是jupyter；用闲置的端口映射到这两个端口上去

![image-20200916162005077](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200916162005077.png)



对于每个user，都会在USERDATA下新建一个属于他们的目录

DATASET里面是公共的数据集

![image-20200915201835499](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200915201835499.png)



最后就是runtime选一下nvidia

![image-20200915201840213](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200915201840213.png)



（4）设置用户远程访问







点击进入命令行

![image-20200916162357777](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200916162357777.png)

![image-20200916163031462](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200916163031462.png)



进入后输入下面的命令

```
screen -S jupyter --开启新会话 
--设置远程启动
jupyter lab --no-browser --ip=0.0.0.0 --allow-root --NotebookApp.token=yyxyyxyyx
ctrl + a+d  --退出
```

如果需要恢复会话

```bash
screen -r jupyter --恢复原来的会话
```

查看所有回话

```
screen -ls  --查看当前窗口运行的所有screen

screen -S 43.jupyter -X quit
```

![image-20200915202312824](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20200915202312824.png)



最后，输入 固定IP:映射到8888上的闲置端口 远程访问服务器。







# Xshell连接服务器

主机:10.129.27.15

端口：22

用户名：infosec

密码：infosec123 （也是服务器的密码）